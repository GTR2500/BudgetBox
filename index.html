<!DOCTYPE html>
<html lang="it" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BudgetBox</title>
  <link rel="stylesheet" href="assets/css/app.css" />
</head>
<body>
  <!-- Header / Topbar -->
  <header class="topbar">
    <div class="topbar-left">
      <img class="logo" alt="Grimaldelli s.r.l." src="https://www.glcgrimaldelli.com/wp-content/uploads/2019/06/Logo-Sottopagine.jpg" />
      <h1 id="title" class="title">BudgetBox</h1>
      <span class="rev-badge">Rev <span id="revVer">â€”</span> Â· <span id="revDate">â€”</span></span>
    </div>
    <div class="topbar-right">
      <button id="themeBtn" class="btn ghost" title="Tema">ðŸŒ™</button>
      <button id="printBtn" class="btn">Stampa/PDF</button>
    </div>
  </header>

  <main class="container">
    <!-- Sezione ANAGRAFICA -->
    <section class="card">
      <div class="card-title">
        <h2>Anagrafica</h2>
      </div>

      <!-- Badge meteo sopra LocalitÃ  -->
      <div class="row">
        <div class="col col-12">
          <div id="badge-meteo" class="badge meta">â€”</div>
        </div>
      </div>

      <div class="row">
        <div class="col col-4">
          <label for="cli">Cliente</label>
          <input id="cli" type="text" placeholder="Ragione sociale / nominativo" />
        </div>
        <div class="col col-4">
          <label for="rif">Riferimento</label>
          <input id="rif" type="text" placeholder="Rif. interno" />
        </div>
        <div class="col col-4">
          <label for="dat">Data</label>
          <input id="dat" type="date" />
        </div>
      </div>

      <div class="row align-end">
        <div class="col col-8">
          <label for="fld-localita">LocalitÃ </label>
          <select id="fld-localita"></select>
        </div>
        <div class="col col-4 align-right">
          <div class="check-wrap">
            <button id="checkBtn" class="btn">Check superficie</button>
            <span id="badge" class="badge">â€”</span>
            <span id="badgePct" class="pct">â€”</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Sezione STRUTTURA -->
    <section class="card">
      <div class="card-title">
        <h2>Struttura</h2>
      </div>

      <div class="row">
        <div class="col col-4">
          <label for="tipoStruttura">Tipo di struttura</label>
          <select id="tipoStruttura"></select>
        </div>
        <div class="col col-4">
          <label for="formaCopertura">Forma copertura</label>
          <select id="formaCopertura"></select>
          <small id="formaDescr" class="help">â€”</small>
        </div>
        <div class="col col-4 sketch-box">
          <div id="sketch"></div>
        </div>
      </div>

      <div class="row">
        <div class="col col-4">
          <label for="prz">Prezzo struttura (â‚¬/mÂ²)</label>
          <input id="prz" type="number" min="0" step="0.01" />
        </div>
        <div class="col col-4">
          <label for="kgBase">Kg acciaio (kg/mÂ²)</label>
          <input id="kgBase" type="number" min="0" step="0.1" />
        </div>
        <div class="col col-4">
          <label for="hColmoVal">Altezza colmo (m) â€” calcolata</label>
          <input id="hColmoVal" type="text" readonly />
        </div>
      </div>

      <div class="row">
        <div class="col col-3">
          <label for="campN">NÂ° campate</label>
          <input id="campN" type="number" min="0" step="1" />
        </div>
        <div class="col col-3">
          <label for="campInt">Passo campate (m)</label>
          <input id="campInt" type="number" min="0" step="0.01" />
        </div>
        <div class="col col-3">
          <label for="len">Lunghezza (m)</label>
          <input id="len" type="number" min="0" step="0.01" />
          <small id="lenNote" class="help"></small>
        </div>
        <div class="col col-3">
          <label for="wid">Larghezza (m)</label>
          <input id="wid" type="number" min="0" step="0.01" />
        </div>
      </div>

      <div class="row">
        <div class="col col-3">
          <label for="hTrave">Altezza trave (m)</label>
          <input id="hTrave" type="number" min="0" step="0.01" />
        </div>
        <div class="col col-3">
          <label for="spTest">Sforo testata (m) â€” fronte/retro</label>
          <input id="spTest" type="number" min="0" step="0.01" />
        </div>
        <div class="col col-3">
          <label for="spGr">Sforo gronda (m) â€” sx/dx</label>
          <input id="spGr" type="number" min="0" step="0.01" />
        </div>
        <div class="col col-3">
          <label for="quo">Quota decubito (%)</label>
          <input id="quo" type="number" min="0" max="100" step="1" />
        </div>
      </div>

      <div class="row">
        <div class="col col-12">
          <label for="not">Note</label>
          <textarea id="not" rows="2" placeholder="Annotazioniâ€¦"></textarea>
        </div>
      </div>

      <div class="row kpi">
        <div class="col col-3"><strong>Area lorda (mÂ²)</strong><div id="areaLorda">â€”</div></div>
        <div class="col col-3"><strong>Copertura in pianta (mÂ²)</strong><div id="areaCoperta">â€”</div></div>
        <div class="col col-3"><strong>Copertura in falda (mÂ²)</strong><div id="areaFalda">â€”</div></div>
        <div class="col col-3"><strong>Area normativa richiesta (mÂ²)</strong><div id="areaNormativa">â€”</div></div>
      </div>

      <div class="row kpi">
        <div class="col col-3"><strong>Costo base (â‚¬/)</strong><div id="costoMq">â€”</div></div>
        <div class="col col-3"><strong>Costo acciaio (â‚¬/)</strong><div id="costoKg">â€”</div></div>
        <div class="col col-3"><strong>Neve & vento</strong><div id="extraMeteo">â€”</div></div>
        <div class="col col-3"><strong>Totale struttura (â‚¬/)</strong><div id="costoStruttura">â€”</div></div>
      </div>
    </section>

    <!-- Sezione POPOLAZIONI & STABULAZIONI -->
    <section class="card">
      <div class="card-title">
        <h2>Popolazioni & stabulazioni</h2>
      </div>

      <!-- RIGA 1 -->
      <div class="row pop">
        <div class="col col-3">
          <label>Bovine adulte</label>
          <input id="n-bovineAdulte" type="number" min="0" step="1" placeholder="N capi" />
          <span id="cap-bovineAdulte" class="badge">0 capi</span>
        </div>
        <div class="col col-3">
          <label>Stabulazione</label>
          <select id="s-bovineAdulte"></select>
        </div>
        <div class="col col-3">
          <label>Livello</label>
          <select id="l-bovineAdulte"><option>Adeguato</option><option>Ottimale</option></select>
        </div>
        <div class="col col-3 vu">
          <label>mÂ²/capo</label>
          <div id="vu-bovineAdulte">â€”</div>
        </div>
      </div>

      <div class="row pop">
        <div class="col col-3">
          <label>Manze bovine</label>
          <input id="n-manzeBovine" type="number" min="0" step="1" placeholder="N capi" />
          <span id="cap-manzeBovine" class="badge">0 capi</span>
        </div>
        <div class="col col-3"><label>Stabulazione</label><select id="s-manzeBovine"></select></div>
        <div class="col col-3"><label>Livello</label><select id="l-manzeBovine"><option>Adeguato</option><option>Ottimale</option></select></div>
        <div class="col col-3 vu"><label>mÂ²/capo</label><div id="vu-manzeBovine">â€”</div></div>
      </div>

      <div class="row pop">
        <div class="col col-3">
          <label>Tori rimonta</label>
          <input id="n-toriRimonta" type="number" min="0" step="1" placeholder="N capi" />
          <span id="cap-toriRimonta" class="badge">0 capi</span>
        </div>
        <div class="col col-3"><label>Stabulazione</label><select id="s-toriRimonta"></select></div>
        <div class="col col-3"><label>Livello</label><select id="l-toriRimonta"><option>Adeguato</option><option>Ottimale</option></select></div>
        <div class="col col-3 vu"><label>mÂ²/capo</label><div id="vu-toriRimonta">â€”</div></div>
      </div>

      <!-- RIGA 2 -->
      <div class="row pop">
        <div class="col col-3">
          <label>Bufale adulte</label>
          <input id="n-bufaleAdulte" type="number" min="0" step="1" placeholder="N capi" />
          <span id="cap-bufaleAdulte" class="badge">0 capi</span>
        </div>
        <div class="col col-3"><label>Stabulazione</label><select id="s-bufaleAdulte"></select></div>
        <div class="col col-3"><label>Livello</label><select id="l-bufaleAdulte"><option>Adeguato</option><option>Ottimale</option></select></div>
        <div class="col col-3 vu"><label>mÂ²/capo</label><div id="vu-bufaleAdulte">â€”</div></div>
      </div>

      <div class="row pop">
        <div class="col col-3">
          <label>Bufale parto</label>
          <input id="n-bufaleParto" type="number" min="0" step="1" placeholder="N capi" />
          <span id="cap-bufaleParto" class="badge">0 capi</span>
        </div>
        <div class="col col-3"><label>Stabulazione</label><select id="s-bufaleParto"></select></div>
        <div class="col col-3"><label>Livello</label><select id="l-bufaleParto"><option>Adeguato</option><option>Ottimale</option></select></div>
        <div class="col col-3 vu"><label>mÂ²/capo</label><div id="vu-bufaleParto">â€”</div></div>
      </div>

      <div class="row pop">
        <div class="col col-3">
          <label>Manze bufaline</label>
          <input id="n-manzeBufaline" type="number" min="0" step="1" placeholder="N capi" />
          <span id="cap-manzeBufaline" class="badge">0 capi</span>
        </div>
        <div class="col col-3"><label>Stabulazione</label><select id="s-manzeBufaline"></select></div>
        <div class="col col-3"><label>Livello</label><select id="l-manzeBufaline"><option>Adeguato</option><option>Ottimale</option></select></div>
        <div class="col col-3 vu"><label>mÂ²/capo</label><div id="vu-manzebufaline">â€”</div></div>
      </div>

      <!-- INGRASSO -->
      <div class="row pop">
        <div class="col col-3">
          <label>Ingrasso â€” gruppi</label>
          <input id="ing-gr" type="number" min="0" step="1" placeholder="N gruppi" />
        </div>
        <div class="col col-3">
          <label>Ingrasso â€” capi per gruppo</label>
          <input id="ing-cpg" type="number" min="0" step="1" placeholder="Capi/gruppo" />
          <span id="cap-ingrasso" class="badge">0 capi</span>
        </div>
        <div class="col col-3">
          <label>Peso medio (kg)</label>
          <input id="ing-peso" type="number" min="200" step="10" value="550" />
        </div>
        <div class="col col-3 vu">
          <label>mÂ²/capo (ingrasso)</label>
          <div id="vu-ingrasso">â€”</div>
        </div>
      </div>

      <div class="row pop">
        <div class="col col-3">
          <label>Stabulazione ingrasso</label>
          <select id="ing-stab"></select>
        </div>
        <div class="col col-3">
          <label>Livello ingrasso</label>
          <select id="ing-liv"><option>Adeguato</option><option>Ottimale</option></select>
        </div>
      </div>
    </section>

    <div class="next-wrap">
      <button id="btn-next" class="btn primary" disabled>Prosegui â†’ Impianti</button>
    </div>
  </main>

  <footer class="footer">
    <div class="footer-left">Â© <span id="titleFooter">BudgetBox</span> per Grimaldelli s.r.l. â€” Manuel Zago</div>
  </footer>

  <script src="assets/js/core.js" defer></script>
  <script>
    window.addEventListener('DOMContentLoaded', function(){
      if (window.PreventivoApp && typeof window.PreventivoApp.initPagina1 === 'function') {
        try { window.PreventivoApp.initPagina1(); } catch (e) { alert("Errore init pagina: " + e.message); console.error(e); }
      } else {
        alert("Script non caricato correttamente. Controlla assets/js/core.js");
      }
    });
  </script>
</body>
</html>
